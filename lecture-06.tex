\section{Monomial orders}


\subsection{Some reminders}

In the following, we will anchor ourselves in the 
rewriting theory that exists for associative monoids
in sets and the corresponding theory for
associative algebras. Since we are not assuming
the reader is familiar with this, let us give
a brief recollection of the basics.

\begin{definition}
An associative monoid is a set $M$ along with
an associative multiplication $\mu : M\times M
\longrightarrow M$. Given a set $X$, we write
$\langle X\rangle$ for the free monoid on 
$X$, which is given by the set
$
 \bigsqcup_{n\geqslant 1} X^{n}
 $
of all \emph{words the alphabet $X$} with
product the isomorphism
$ X^n\times X^m \cong X^{m+n}$
for each $m,n\geqslant 1$.
\end{definition}

We are interested in finding bases of 
free objects by ideals and, to do this,
we will resort to ordering our free objects.
This will allow us to give a (terminating)
algorithm whose input will be a set of 
relations and an ordering, and whose
output (among other things) will 
be a basis of our quotient object.

\begin{definition}

An ordered monoid is a pair $(M,\prec)$ where $M$ is a monoid
and $\prec$ is a total order on $M$ that satisfies the
following three conditions:
\begin{tenumerate}
\item It is a well-order: every non-empty subset of $M$
has a minimum. 
\item The product map of $M$ is increasing in both of its
arguments for $\prec$. 
\end{tenumerate}
A \emph{monomial order} on the alphabet $X$ is, by definition,
the structure of an ordered monoid on the free monoid $\langle X\rangle$
generated by $X$.
\end{definition}

Explicitly, the last condition requires that if $m_1,m_2,m_3\in M$
and if $m_1\prec m_2$ then it follows that $m_3m_1\prec m_3m_2$ 
and $m_1m_3\prec m_2m_3$. If the alphabet $X$ is given a total order, 
then we can produce a monomial order on it as follows:

\begin{definition}
Let $\prec$ be a total order on $X$. 
The graded lexicographic order on $\langle X\rangle$
induced by $\prec$, which we write $\prec_\ell$,
is such that $w\prec_\ell w'$ if and only if
\begin{tenumerate}
\item The word $w$ is shorter than $w'$, or else
\item $w$ and $w'$ have the same length
but
$w = w_1 xw_2$ and $w' = w_1 y w_2'$ with
$x\prec y$ in $X$.
\end{tenumerate}
\end{definition}

It is important to note that the lexicographic order defined only
by the second condition is \emph{not} a well-order, and it is 
not increasing for the concatenation product: for example,
if $x\prec y$ then $x \prec x^2$ but $x^2y \prec xy$. 

\begin{lemma}
The graded lexicographic order is a monomial order on $\langle X \rangle$
for any choice total order $\prec$.
\end{lemma}

\begin{proof}
It is clear that the resulting order is total, for either
two words are of distinct length, or they are of the same length
and differ at and entry, or else they are equal. To see the
order behaves well with respect to the concatenation product,
we observe that the function $w\longmapsto \mathrm{Length}(m)$
is additive for the concatenation product, so if $w$ is longer
than $w'$, then $ww''$ will be longer than $w'w''$ and,
similarly, $w''w$ will be longer than $w''w'$. If $w$ and 
$w'$ have the same length, then it is clear that
$w''w'\prec w''w$ if and only if $w'w''\prec ww''$ if
and only if $w' \prec w$. To see that the order is a well
order, let us consider a collection $W$ of words. Then,
in particular, there exists a least natural number $n$
such that $W$ contains words of length $n$ but not of $n-1$. 
In this case, it follows that the minimum of $W$, if it
exists, must be contained in the set $X^n$, and this
set is well ordered by the lexicographical order if
$X$ it itself well ordered: we can find the minimum 
by induction on $n$.
\end{proof}

We now recall Lecture~\ref{lecture:thebasics} the 
definition
of the \emph{word operad of a monoid $M$},
which appeared recently in~\cite{Dotsenko2020}.


\begin{definition}
Let $M$ be an associative monoid. The symmetric
operad $\mathbb W_M$ is defined by $\mathbb{W}_M(n) =
M^n$ for each $n\geqslant 1$, and its partial composition
product is defined for each $s,t\geqslant 1$ and each
$i\in [s]$ by the rule
\[(m_1,\ldots,m_s) \circ_i (m_1',\ldots,m_t') = 
 	(m_1,\ldots,m_{i-1}, m_im_1',\ldots,m_im_t',m_{i+1},\ldots, m_s).\] 
\end{definition}

The reader should verify that $\mathbb W_M$ is isomorphic,
as a symmetric sequence, to the composition product $\mathrm{Ass}\circ M$,
where we consider $M$ a symmetric sequence concentrated in arity $1$. 

\subsection{Two statistics}

Of particular interest to us is the case $\XX$ is
a reduced symmetric sequence in sets, and we let
$\underline{\XX} = \bigsqcup_{n\geqslant 1} \XX(n)$
be the underlying alphabet of $\XX$. We will use
the notation $\XX^*$ for the free monoid $\langle 
\underline{\XX}\rangle$. By definition, there
exists a unique map of shuffle operads
$
\pi : \FF_\XX^\Sha \longrightarrow
						\mathbb W_{\XX^*} 				
$ 
extending the map $\XX \longrightarrow \mathbb W_{\XX^*}$
that assigns $x\in \XX(n)$ to the element
$(x,\ldots,x)\in \mathbb W_{\XX^*}(n)$.

\begin{definition}
For each shuffle tree monomial $T$, we call 
$\pi(T)$ the \emph{path sequence of $T$.}
\end{definition}

The path sequence of a shuffle tree monomial $T$ can
be computed in a straight-forward way, as the following
lemma shows. The useful observation that the previous
definition allows us to make is that the path
sequence statistic is compatible with shuffle 
compositions of tree monomials, in the sense the
path sequence of a composition of tree 
monomials equals the compositions
of the corresponding path sequences of these
tree monomials.
 
\begin{figure}[h]
\[ 
	\leftc{x}{y}{1}{2}{3}
 \quad
		\leftc{x}{y}{1}{3}{2} 
		\qquad
		\rightc{y}{x}{1}{2}{3}
		\]
		\[ \hspace{0.4 in}(yx,yx,y)
			\hspace{.8 in} (yx,y,yx)
				\hspace{0.8 in}(y,yx,yx)\]
		\caption{An example of the computation of path sequences.}
		\label{fig:paths}
		\end{figure}
		
\begin{lemma}
Let $\XX$ be reduced. 
The path sequence of $T$ is the tuple in $\mathbb{W}_{\XX^*}(n)$
where $n$ is the number of leaves of $T$, obtained by recording at the
$i$th entry the word in $\XX$ read by travelling from the root of
$T$ to the leaf labelled by $i$.
\end{lemma}

More generally, in case $\XX$ has $0$-ary variables, we must look at 
all \emph{endpoints} of a tree monomial. Since we will not be
interested in non-reduced alphabets, we let the curious reader
explore this modification on their own. It is useful to remark
in situations like this that $\underline{\XX}$ is obtained 
through a disjoint union of the components
of $\XX$: the path sequence of $x\circ_1 y$ for $x$ and $y$ unary
is $(xy)$, and the path sequence of $x\circ_1 y'$ for $x$ unary and
$y'$ nullary is `also' $(xy')$, but these are \emph{distinct}
in the free monoid $\XX^*$. 

\begin{proof}
This is Exercise~\ref{ex:pathseq}.
\end{proof}

Let us now consider the unique  map of shuffle operads
$\sigma : \FF_\XX^\Sha \longrightarrow
						\mathsf{Ass}$ 
extending the map $\XX \longrightarrow \mathsf{Ass}$
that assigns $x\in \XX(n)$ to the identity
$1\in \mathsf{Ass}(n) = S_n$. 

\begin{definition}
If $T$ is a shuffle tree monomial. 
we call $\sigma(T)$ the (leaf) permutation sequence of $T$.
We call the pair $(\pi(T),\sigma(T))$ the
path-permutation data of $T$. 
\end{definition}

As before, this statistic of $T$ has a simpler description,
that can be read off directly from $T$, and the previous
definition tells us that the leaf permutation
sequence of a tree monomial behaves well with
respect to shuffle compositions.

\begin{figure}
\[
\fork{x}{y}{x}{1}{3}{2}{4}
\qquad
\fork{x}{y}{x}{1}{4}{2}{3}
\qquad
\fork{x}{y}{x}{1}{2}{3}{4}
\]
\caption{Three different shuffle three monomials with the same path
sequence, but different permutation sequence.}
\end{figure}

\begin{lemma}
The permutation sequence of $T$
 is obtained by reading the leaf labelling of $T$ from
left to right and recording it as a permutation in
``two line notation''.
\end{lemma}

The main result of this section tells us that it suffices
for us to order sequences of words in the alphabet $\XX$
and permutations in order to order shuffle tree monomials.

\begin{theorem}
The map $\FF_\XX^\Sha \longrightarrow \mathbb{W}_{\XX^*}\times
\mathsf{Ass}$ of the free shuffle operad on $\XX$ into the 
Hadamard product of $\mathbb{W}_{\XX^*}$ and $\mathsf{Ass}$
induced by $\pi$ and $\sigma$ is injective.
In other words, the path-permutation datum of a shuffle
tree monomial determines it uniquely.
\end{theorem}

Let us call the map in the statement of the theorem the
\emph{path-permutation inclusion}.

\begin{proof}
We will sketch a proof, and ask the reader to fill in the
details as an exercise; we proceed by induction on the
total length of the path sequence of a tree monomial so that,
for example, the path sequences appearing in Figure~\ref{fig:paths}
have all length five. First, let us show that the path sequence
determines the planar structure of our tree monomial uniquely:

If the length is zero, then the path sequence $\pi$
is empty, and we are simply considering the trivial tree monomial.
Let us consider now some positive length $\ell$ and search,
among all words $w$ appearing in $\pi$, that which has
the largest possible length and smallest possible coordinate,
let us say this coordinate is $i$.

If $w$ ends in a $0$-ary variable of $\XX$, this means the
$i$th leaf of $T$ ends at a stump, and we can remove it, 
and continue by induction. If not, then $w$ ends with
some variable $x\in \XX(k)$, and the way we have chosen
it implies that the $i$th leaf (in the planar order)
is the first child of $x$, and that all other children
of $x$ are also leaves. It follows that $w$
and the next $k-1$ words in $\pi$ all end with $x$,
and that $\pi$ is obtained as a non-symmetric composition
with $(x,\ldots,x)$. By pruning $x$ from $\pi$, we
can proceed by induction. 

Now that we know the path sequence recovers the planar structure
of $T$ uniquely, let us pick some path-permutation datum
$(\pi,\sigma)$. Then, reorder the entries of $\pi$ using
$\sigma^{-1}$ to recover the planar structure of $T$,
and then label its leafs according to $\sigma$, to 
recover the whole shuffle structure.
\end{proof}


\subsection{Ordered shuffle operads}

We can now proceed to define ordered shuffle operads. 

\begin{definition}
A set shuffle operad $\PP$ is order if for each $n\geqslant 0$
the component $\PP(n)$ is well-ordered and if shuffle compositions
are increasing in each of its arguments: for each $n\geqslant 1$,
all elements $(T_0;T_1,\ldots,T_n) \in\PP(k)\times \PP(n_1)
\times \cdots\times \PP(n_k)$ and all shuffling partitions
of $\underline{n}$ for $n=n_1+\cdots +n_k$, we have that
\[ 
\gamma_\pi(T_0;T_1,\ldots,T_i, \ldots, T_n)  \prec
\gamma_\pi(T_0;T_1,\ldots,T_i',\ldots,T_n)
\]
whenever $T_i\prec T_i'$  for some $i\in [0,n]$ as elements
of $\PP(n_1+\cdots+ n_k)$. 
\end{definition}

In particular, we can apply this definition in the case $\PP$
is the free shuffle set operad on some alphabet $\XX$. As
promised, let use 
the injection $(\pi,\sigma)$ to endow tree monomials with
well-orders. 

\begin{proposition}[Proposition 1.6 in ~\cite{Dotsenko2020}]
Let $(M,\prec)$ be an ordered monoid. The
word operad on $\mathbb W_M$ is an ordered operad
through the lexicographical order of words.
\end{proposition}

\begin{proof}
This is Exercise~\ref{ex:orderedM}.
\end{proof}

In particular, we can consider the case in which $M = \XX^*$
is endowed with the graded lexicographical order induced by
a total order on $\underline{\XX}$, which implies the following
corollary.

\begin{corollary}
Suppose that $\underline{\XX}$ is given a total order, and that
we give the free monoid $\XX^*$ the induced graded 
lexicographical order. Then
the word operad $\mathbb{W}_{\XX^*}$ is an ordered
shuffle operad with the lexicographical order.
\end{corollary}

We leave it as an exercise to the reader to show that the
associative operad is an ordered shuffle operad if we
use on it the lexicographic order on permutations
(seen as strings of numbers, in one line notation).
All our work is now, done:

\begin{definition}
Let $\XX$ be an alphabet and suppose that we
give the monoid $\XX^*$ a monomial order $\prec$.
The \emph{path-permutation extension} of $\prec$ is the
unique order on $\FF_{\XX}^\Sha$ induced by
the path-permutation inclusion, where we use the
the induced lexicographic
order on $\mathbb{W}_{\XX^*}$ first, and the
lexicographic order on $\mathsf{Ass}$ second.
\end{definition}

Naturally, one can switch the roles of the two
factors of the path-permutation inclusion to get
the \emph{permutation-path extension} of a monomial
order on $\XX^*$. We will explore other variations
in the exercises.

\begin{definition}
Let us fix a total order $\prec$ on $\underline{\XX}$, and let us
consider the induced graded lexicographic order on 
$\XX^*$, where we first compare the length of a 
word, and then use the lexicographic order induced
by the total order. The path-permutation extension 
on $\FF_\XX^\Sha$ is called the  \emph{graded path-permutation 
lexicographic order} induced by $\prec$.
\end{definition}

For example, let us consider the case in which $\XX$ is binary
and contains exactly two operations $x$ and $y$. The next
figure shows the \texttt{grapathpermlex} order induced by $x<y$
on all possible twelve tree monomials with three leaves on $\XX$;
largest elements appear first, from top left to bottom right.

\[ 
	\leftc{y}{y}{1}{2}{3}
 \quad
		\leftc{y}{y}{1}{3}{2}
		\qquad
			\leftc{x}{y}{1}{3}{2} 
		\]
		\[ \hspace{0.4 in}(yy,y,y)
			\hspace{.8 in}(yy,y,yy) \hspace{0.8 in}
			(yx,yx,x)
				\]
		
\[ 
\leftc{x}{y}{1}{3}{2}
 \quad
			\leftc{y}{x}{1}{2}{3}
		\qquad
	\leftc{y}{x}{1}{3}{2} 
		\]
		\[ \hspace{0.4 in}(yx,x,yx)
			\hspace{.8 in} (xy,xy,x)
				\hspace{0.8 in}(xy,x,xy)\]
		
\[ 
\leftc{x}{x}{1}{2}{3} \quad
\leftc{x}{x}{1}{3}{2} 	\qquad
\rightc{y}{y}{1}{2}{3}
		\]
\[ \hspace{0.4 in}(xx,xx,x)
			\hspace{.8 in} (xx,x,xx)
				\hspace{0.8 in}(y,yy,yy)\]

\[ 
\rightc{y}{x}{1}{2}{3} \quad
\rightc{x}{y}{1}{2}{3}		\qquad
\rightc{x}{x}{1}{2}{3}
		\]
		\[ \hspace{0.4 in}(y,yx,yx)
			\hspace{.8 in} (x,xy,xy)
				\hspace{0.8 in}(x,xx,xx)\]
		
		



\newpage

\subsection{Exercises}
 
\begin{question}\label{ex:pathseq}
Show that the path sequence of a tree monomial, as defined
using the universal property of the free shuffle operad,
coincides with its combinatorial definition obtained
by reading the entries of the tree from the
root to the leaves.
\end{question}
 
\begin{question}
Let $X$ be a finite set and let us give 
$\langle X\rangle$ the graded lexicographical order with
respect to a fixed total order on $X$. Show this is a
monomial order.
\end{question}

\begin{question}\label{ex:orderedM}
Suppose $(M,\prec)$ is an ordered monoid and
we let us give the shuffle operad
$\mathbb{W}_M$ the induced lexicographical 
order. Show that the resulting order is a monomial
order.
\end{question}

\begin{question}
Consider the ns collection $\XX$ with $\underline{\XX} = \XX(2)$
a singleton. Show that we can always find a monomial order that
singles out one of the three shuffle tree monomial basis
elements of $\FF_\XX^\Sha(3)$ as the largest. 
\end{question}

\begin{question}
Consider the ns collection $\XX$ with $\underline{\XX} = \XX(2)
= \{x,y\}$, and the ``mixed'' shuffle tree monomials in 
$\FF_\XX^\Sha(3)$ that have $x$ and $y$ (one at the top,
the other at the bottom). Explore what leading terms
you can obtain by choosing different induced orders
on $\FF_\XX^\Sha$.
\end{question}