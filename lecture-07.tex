
\section{Gr\"obner bases}\label{lecture:GB1}

\textbf{Goal.} Define the long division algorithm for shuffle
tree polynomials. Prove Gr\"obner bases for shuffle operads exist
and reduced Gr\"obner bases are unique.

\subsection{Tree insertion}

\begin{definition}
Let $T'$ and $T$ be tree monomials over some fixed alphabet $\XX$.\
We say that $T'$ divides $T$ if the underlying tree $\tau$
of $T$ contains a subtree $\tau_0$ isomorphic to the underlying
tree $\tau'$ of $T'$, whose induced shuffling labelling
 and decorations coincide with that of $T'$.
 \end{definition}
\begin{figure}[h]
\[
\fork{x}{y}{x}{1}{3}{2}{4}
\mathsymbol{1.5}{\text{is divisible by}}
\begin{tikzpicture}[scale = .75]
	\begin{pgfonlayer}{main}
		\node [style=inner] (0) at (0, 0) {$x$};
		\node [style=inner] (2) at (-1, 1) {$x$};
		\node [style=leaf] (9) at (1, 1) {$2$};
		\node [style=leaf] (10) at (0, -1.25) {};
		\node [style=leaf] (11) at (-1.5, 2) {$1$};
		\node [style=leaf] (12) at (-0.5, 2) {$3$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{bg}
		\draw (2.center) to (0.center);
		\draw (0.center) to (9.center);
		\draw (0.center) to (10.center);
		\draw (2.center) to (11.center);
		\draw (12.center) to (2.center);
	\end{pgfonlayer}
\end{tikzpicture}
\mathsymbol{1.5}{\text{and by}}
\begin{tikzpicture}[scale = .75]
	\begin{pgfonlayer}{main}
		\node [style=inner] (0) at (0, 0) {$x$};
		\node [style=leaf] (2) at (-1, 1) {$1$};
		\node [style=inner] (9) at (1, 1) {$y$};
		\node [style=leaf] (10) at (0, -1.25) {};
		\node [style=leaf] (13) at (0.5, 2) {$2$};
		\node [style=leaf] (14) at (1.5, 2) {$3$};
	\end{pgfonlayer}
	\begin{pgfonlayer}{bg}
		\draw (2.center) to (0.center);
		\draw (0.center) to (9.center);
		\draw (0.center) to (10.center);
		\draw (13.center) to (9.center);
		\draw (9.center) to (14.center);
	\end{pgfonlayer}
\end{tikzpicture}
\]
\caption{A ``fork'' and its divisors of weight two. Notice the induced labelling of the right comb, coming from the
shuffling labelling $1<2<4$.}
\end{figure}

The following lemma asserts that the combinatorial notion
of divisibility coincides with the algebraically inclined
notion of divisibility, that of belonging to the ideal
generated by the divisor. 

\begin{lemma}
A tree monomial $T$ is divisible by another
tree monomial $T'$ if and only if it can be obtained
from $T'$ by iterated shuffle compositions with
other tree monomials.
\end{lemma}

\begin{proof}
It is clear that if $T$ is obtained from $T'$ by
iterated shuffle compositions with tree monomials,
then $T$ is divisible by $T'$. Conversely, suppose
$T'$ divides $T$. If the root of $T'$ is not that of
$T$, then we can write $T$ as a composition of several
tree monomials, one which is divisible by $T'$ and
which shares the root with it, so we may assume this is
the case. One this is done, we see that $T$ is in fact
obtained by grafting tree monomials at the leaves of $T'$,
and completes the proof.
\end{proof}

\begin{figure}[t]

\[
\Leftc{x}{y}{x}{1}{3}{2}{4}
\mathsymbol{1.5}{\text{is divisible by}}
\leftc{x}{y}{1}{3}{2}
\mathsymbol{1.5}{\text{and by}}
\leftc{y}{x}{1}{2}{3}
\]
\caption{A right comb with two divisors that have
the same underlying planar structure but different
induced labelling.}
\end{figure}
\begin{definition}
Suppose that $T'$ is a divisor of $T$, and let us
assume that $T'$ has $\ell'$ leaves and $T$
has $\ell$ leaves. We define the insertion operation
\[
\repl{T'}{T}{-}: \FF_\XX^\Sha(\ell') \longrightarrow 	
 \FF_\XX^\Sha(\ell) 
\]
that replaces the divisor $T'$ of $T$ by any other
shuffle tree monomial with $\ell'$ leaves
in $T$, and extend it linearly, making sure
that leaf labels are respected.
\end{definition}
\begin{figure}[b]
\[
\Leftc{x}{x}{x}{1}{2}{3}{4}
\mathsymbol{1.5}{\text{ is divisible ``twice'' by}}
\leftc{x}{x}{1}{2}{3}
\]
\caption{A right comb with two divisors that have the
same induced shuffle tree structure, but happen
at different places of the tree.}
\end{figure}
\begin{lemma}
Let $\mathcal{V}$ be a subset of the free shuffle operad on $\XX$.
Then the ideal generated by $\mathcal{V}$ is explicitly obtained
as the linear span of all insertions $\repl{T'}{T}{f}$
as $T,T'$ range through pairs $(T',T)$ with $T'$ a divisor
of $T$ and $f\in \mathcal V(\ell')$.
\end{lemma}

\begin{figure}[h]
\[
\begin{tikzcd}
{} &\phantom{\hspace{-3.5 em}}\Leftc{x}{x}{x}{}{}{}{} 
	\arrow[dr] 
	\arrow[dl] \\
\fork{x}{x}{x}{}{}{}{}&  {} & \Leftr{x}{x}{x}{}{}{}{}
\end{tikzcd}
\]
\caption{Two possible results of substituting
a left comb by a right comb in the topmost tree.}
\end{figure}

\begin{proof}
By construction, $(\mathcal V)$ is the linear span of all possible
shuffle compositions where at least one summand is contained in
$\mathcal V$. Since shuffle compositions are multilinear, we can
assume that all terms appearing in such shuffle compositions (except,
possibly, for that in~$\mathcal V$) are tree monomials, in which case
the resulting shuffle composition coincides with an insertion
operation.
\end{proof}

\subsection{Long division}

Suppose that we fix a tree monomial order on the free
shuffle operad $\FF_\XX^\Sha$ and $f \in \FF_\XX^\Sha(n)$
is a tree \emph{polynomial}. The support of $f$ is the (finite)
set of tree monomials that appear in $f$ with non-zero coefficient.
We say the tree monomial $T$ is
the \emph{leading monomial of $f$} if $T$ is the largest monomial
that appears in the support of $f$, and we write the corresponding
summand in $f$ by $\leadm{f}$. This summand is accompanied by a
coefficient, which we call the leading coefficient of $f$ and
write $\leadc{f}$. Thus, any $f$ can be written in the form
\[ f = \leadc{f} \leadm{f} + f_0 \]
where all monomials appearing in $f_0$ are smaller than $\leadm{f}$.
We call $\leadc{f} \leadm{f}$ the leading term of $f$ and write
it $\lead{f}$. We begin with a preparatory result.

\begin{figure}[h]
\[ 
	\mathsymbol{1.5}{f_1 =}	\underline{\leftc{x}{y}{1}{2}{3}}
\mathsymbol{1.5}{+}		\leftc{x}{y}{1}{3}{2} 
		\mathsymbol{1.5}{+}	
		\rightc{y}{x}{1}{2}{3}
		\]
		\[ 
	\mathsymbol{1.5}{f_2 =}	\leftc{x}{x}{1}{2}{3}
\mathsymbol{1.5}{-}	\underline{\leftc{x}{y}{1}{3}{2} }
		\]
		\[ 
	\mathsymbol{1.5}{f_3 =}	 \underline{\leftc{x}{y}{1}{2}{3}}
		\mathsymbol{1.5}{-}	
	\rightc{x}{x}{1}{2}{3} \mathsymbol{1.5}{+}	 \rightc{y}{y}{1}{2}{3}
		\]
		\caption{Leading terms underlined in some tree polynomials, for
		the \texttt{grpathpermlex} order induced by $y>x$.}
		\label{fig:orders}
		\end{figure}
		
		
\begin{proposition}\label{prop:repllead}
Suppose that $T'$ is a divisor of $T$ and let $f\in \FF_\XX^\Sha(\ell')$.
Then the leading term of the insertion $\repl{T'}{T}{f} $
is equal to $\repl{T'}{T}{\lead{f}}$.
\end{proposition}

\begin{proof}
For tree polynomials $f_0,f_1,\ldots,
f_n$ and any shuffling partition $\pi$, we have that
\[ \lead{\gamma_\pi(f_0;f_1,\ldots,f_n) }= 
 		\gamma_\pi(\lead{f_0};\lead{f_1},\ldots,\lead{f_n}).
 		\]
This is clear, since the shuffling compositions are by definition
(strictly) increasing for $\prec$. Since we know that $\repl{T'}{T}{f}$
is obtained from $f$ be iterating shuffle compositions, this proves
the statement of the proposition. 
\end{proof}

Let $\mathcal{V}$ be a subset of the free shuffle operad on $\XX$. A
tree monomial $T$ is \emph{reduced with respect to $\mathcal{V}$} if it is
not divisible by any of the leading terms of polynomials appearing in it.
A polynomial is \emph{reduced with respect to $\mathcal V$} if it is a linear
combination of tree monomials that are reduced. We say $\mathcal V$
is \emph{self-reduced} if each $v\in \mathcal V$ is reduced with respect to
$\mathcal V\smallsetminus v$, and that is is linearly self-reduced
if no leading term of one element appears as the leading term of 
another. 

\begin{definition}[Reduction]\label{def:reduce}
Suppose that $f$ and $g$ are polynomials of the same arity, and
that $f$ is divisible by the leading term of $g$, in other words,
suppose that $\lead{f} = \repl{T'}{T}{\lead{g}}$ for some
tree monomial $T$ and a divisor $T'$. In this case,
the reduction of $f$ with respect to $g$, which we write
$r_g(f)$, is defined by
\[
r_g(f) = f - \frac{\leadc{f}}{\leadc{g}} \repl{T'}{T}{g}.
\]
\end{definition}

The following lemma tells us that the reduced term $r_g(f)$ 
behaves like a ``remainder by division'', in the sense it is
either zero of ``smaller than $f$''.

\begin{lemma}\label{lemma:smaller}
For all $f$ and $g$ such that $r_g(f)$ is defined, either
$r_g(f)= 0$, or else we have that $\lead{r_g(f)} \prec \lead{f}$.
\end{lemma}

\begin{proof}
If $r_g(f)$ is non-zero, we have that its leading coefficient is 
equal to the leading coefficient of $f- \frac{\leadc{f}}{\leadc{g}}\repl{T'}{T}{g}$. But the leading term of the second term is, by
Proposition~\ref{prop:repllead}, equal to 
\[ \frac{\leadc{f}}{\leadc{g}}\repl{T'}{T}{\lead{g}} =  \leadc{f} \leadm{f} 
	= \lead{f}.\]
It follows that the terms appearing in $r_g(f)$ are all strictly smaller
than the leading term of $f$, as we wanted. 
\end{proof}

\textbf{Long division algorithm.}
Let us now define the long division algorithm for shuffle operads.
Its input is a polynomial $f$ and a finite set $\mathcal V$, both
in $\FF_\XX$, and its
output is a reduced element $\overline{f}$ with respect to $\mathcal
V$ such that $f-\overline{f} \in (\mathcal V)$ and $\lead{\overline{f}}
\preceq \lead{f}$. We can verbosely describe the algorithm as follows: 
\begin{tenumerate}
\item If our input polynomial
$f$ is zero, just return zero. If not, ensure $\mathcal V$
is linearly self-reduced, using the linear self-reduction algorithm to put a matrix
in row reduced echelon form.
\item If there is an element $v$ in $\mathcal V$ 
whose leading term divides the
leading term of $f$, pick that with the largest leading term.\footnote{This
 can be done since we already ensured $\mathcal V$ is linearly
self reduced.}
\item Let $f'$ be the remainder of division of $f$
by $v$ using the reduction procedure of Definition~\ref{def:reduce}.
Recursively call the algorithm to compute the result of long
division of $f'$ by $V$.
\item If not, then $\lead{f}$ is $\mathcal V$-reduced, 
so let $f'$ be the result of long division of $f-\lead{f}$ by $\mathcal V$, and return $\lead{f} + f'$.
\end{tenumerate}
Below we present the algorithm in pseudo-code.
\begin{algorithm}
\caption{Long division algorithm}\label{euclid}
\textsc{Input:} A polynomial $f$ and a finite set $\mathcal V$
of tree polynomials.

\textsc{Output:} A $\mathcal V$-reduced polynomial $\overline{f}$ with $f-\overline{f} \in (\mathcal V)$ and $\lead{\overline{f}}
\preceq \lead{f}$.
\begin{adjustwidth}{1 cm}{1 cm}
\begin{algorithmic}[1]
\Procedure{LongDivision}{\texttt{TreePolynomial},\texttt{TreePolynomials}}
\If {$\texttt{TreePolynomial}=0$} \Return $0$
	 \Else
	 \State $\texttt{Dividend} \gets \texttt{TreePolynomial}$
	 \State $\texttt{Divisors} \gets 
	 	\textsc{LinearSelfReduce}(\texttt{TreePolynomials})$
	 \State $\texttt{Factors} \gets \{ v\in \texttt{Divisors} :\leadm{v} \text{ divides } \lead{g}\}$
	\If {$\texttt{Factors} \neq \varnothing$}
	\State $\texttt{LargestFactor}\gets \textsc{Largest}(\texttt{Factors})$   
	\State $\texttt{Dividend}\gets \textsc{Reduce}(\texttt{Dividend},\texttt{LargestFactor})$ 
	\State $\texttt{Dividend}\gets \textsc{LongDivision}(\texttt{Dividend},\texttt{Divisors})$  
		\EndIf
	\State $\texttt{LeadDividend} \gets \lead{\texttt{Dividend}}$
	\State $\texttt{Dividend} \gets \texttt{Dividend}-\texttt{LeadDividend}$
	\State $\texttt{Dividend} \gets \textsc{LongDivison}(\texttt{Dividend},\texttt{Divisors})$
	\EndIf
	\State \Return $\texttt{LeadDividend} + \texttt{Dividend}$
\EndProcedure
\end{algorithmic}
\end{adjustwidth}
\end{algorithm}


\begin{lemma}
The long division algorithm terminates, and its
output is a reduced element $\overline{f}$ with respect to $\mathcal
V$ such that $f-\overline{f} \in (\mathcal V)$ and $\lead{\overline{f}}
\preceq \lead{f}$.
\end{lemma}


\begin{proof}
At each step, the leading monomial of $f$ is decreased Lemma~\ref{lemma:smaller},
so the fact that $\prec$ is a well order guarantees our algorithm
terminates. It also guarantees that the output will satisfy
$\lead{\overline{f}} \preceq \lead{f}$. Let us suppose, for the sake
of a contradiction, that the output of the algorithm is not
always reduced. Among such problematic polynomials $f$,
let us pick one $f$ with the smallest leading term, which is
possible since $\prec$ is a well order. If $\lead{f}$ is not
reduced, then the first step of our algorithm applies long
division to $r_g(f) = f'$ for some $g\in\mathcal V$, and
by Lemma~\ref{lemma:smaller}, this is either zero or has a smaller
leading term than $f'$, so it must be reduced. If $\lead{f}$
is reduced, then the second step of the algorithm applies long
division to $f-\lead{f}$, which has smaller leading term than
$f$, so the output is again reduced. Finally, note that
at each step of the algorithm we subtract an element of
$\mathcal V$, so the coset of $f$ is not modified,
which concludes our proof.
\end{proof}

\begin{proposition}
Suppose that $\mathcal I$ is an ideal in the free shuffle
operad generated by $\XX$. Then those shuffle monomials that
are reduced with respect to $\mathcal I$ form a basis
for the quotient operad $\FF_\XX / \mathcal I$.  
\end{proposition}

\begin{proof}
Let us first show that these monomials span the quotient operad.
This follows, for the long division algorithm guarantees
we can always replace a non-reduced polynomial $f$ by a reduced
one without affecting its coset. To see they are linearly
independent, suppose that $f$ is a polynomial reduced with
respect to $I$, and that $f\in \mathcal I$. Then we see that
$\lead{f} \in \lead{\mathcal I}$. But this can only happen if
$f=0$ (or else $f$ would not even be linearly reduced with respect
to $\mathcal I$). 
\end{proof}

In practice, we
have little control over the multitude of leading terms
that may appear in the elements of $\mathcal I$,
and Gr\"obner bases are designed to regain this control. 
 
 \bigskip
 
 \textbf{Self-reduction algorithm.} Suppose that
 $\mathcal V$ is a finite subset of $\FF_\XX^\Sha$. 
 The following
 algorithm takes as input this generating set,
 and outputs a self-reduced subset $\mathcal V'$
 that generates the same ideal as $\mathcal V$. 
 This is what this algorithm looks like in pseudo-code, 
 though we are being slightly imprecise: $\mathcal V$ is
 not a matrix, so we cannot feed it to our linear self
 reduction algorithm as is: we pick a total order on
 $\mathcal V$, and then use the corresponding matrix
 written in the shuffle tree monomial basis. 
 
 \begin{algorithm}
\caption{Self-reduction algorithm}\label{algo:self-reduce}
\textsc{Input:} A finite set of polynomials $\mathcal V$ in a
free shuffle operad.

\textsc{Output:} A finite self-reduced set of polynomials 
generating the same ideal as $\mathcal V$.
\begin{adjustwidth}{1 cm}{2 cm}
\begin{algorithmic}[1]
\Procedure{SelfReduce}{$\texttt{Polynomials}$}
	\State $\texttt{ToReduce} \gets \textsc{LinearSelfReduce}(\texttt{Polynomials})$
\If {$\texttt{ToReduce}$ is self reduced} \Return $\texttt{ToReduce}$
\Else 
\State $\texttt{Largest} 
	\gets \textsc{Largest}(\texttt{ToReduce})$
\State $\texttt{ToReduce} \gets \textsc{SelfReduce}(\texttt{ToReduce}\smallsetminus \texttt{Largest} )$
\State $\texttt{NewElement} \gets \textsc{LongDivision}(\texttt{Largest} ,\texttt{ToReduce})$
\State $\texttt{ToReduce}\gets \texttt{ToReduce}\cup \texttt{NewElemet}$
\EndIf
\State \Return $\textsc{SelfReduce}(\texttt{ToReduce})$
\EndProcedure
\end{algorithmic}
\end{adjustwidth}

\end{algorithm}

 \begin{proposition}\label{lemma:self-reduction}
 The self-reduction algorithm terminates for each
 finite set $\mathcal V$ and returns a self-reduced
 set $\mathcal V'$ with $(\mathcal V) = (\mathcal V')$.
\end{proposition}  

\begin{proof}
This is Exercise~\ref{ex:self-reduction}.
\end{proof}
\subsection{Existence and uniqueness}

\begin{lemma}
Let $\mathcal I$ be an ideal of $\FF_\XX$. The subspace 
\[
\lead{\mathcal I} = \langle T \in \FF_\XX : \text{ $T = 
	\lead{f}$ for some  $f\in\mathcal I$} \rangle.
\]
spanned by leading terms of elements of $\mathcal I$ is
again an ideal of $\FF_\XX$.
\end{lemma}

\begin{proof}
By construction $\lead{\mathcal I}$ is a subspace of $\FF_\XX$, so 
it suffices we prove it is an ideal. By multilinearity, it suffices
to show it is stable under compositions with respect to tree
monomials if at least one term is already in $\lead{\mathcal I}$.
To do this, note that if
$T$ is the leading term of some $f\in\mathcal I$, then by
Proposition~\ref{prop:repllead}, for any tree monomials
$T_0,\ldots,T_{i-1},T_{i+1},\ldots,T_n$, the leading term
of the composition 
\[ \gamma_\pi(T_0;T_1,\ldots,T_{i-1},f,T_{i+1},\ldots,T_n)\in \mathcal I\]
is precisely $\gamma_\pi(T_0;T_1,\ldots,T_{i-1},T,T_{i+1},\ldots,T_n)$,
which proves this belongs to $\lead{\mathcal I}$.
\end{proof}

\begin{definition}
Let $\mathcal I$ be an ideal of $\FF_\XX$. We say that a subset
$\mathcal G$ of $\mathcal I$ is a \emph{Gr\"obner basis of $\mathcal I$}
(with respect to our fixed monomial order) if the set of leading monomials
of $\mathcal G$ generate the ideal of leading terms of $\mathcal I$.
A Gr\"obner basis which is self-reduced is called reduced.
\end{definition}

\begin{lemma}
Let $\mathcal I$ be an ideal and let $\mathcal G$ be a 
Gr\"obner basis of $\mathcal I$. Then $\mathcal G$ 
generates $\mathcal I$.  
\end{lemma}

\begin{proof}
Suppose that there is some $f\in \mathcal I$ that is not
generated by $\mathcal G$, and let us pick one with the least 
possible leading term. Since $\mathcal G$ generates the
ideal of leading terms of $\mathcal I$, we can reduce
the leading term of $f$ with respect to $\mathcal G$
without modifying its coset in $\mathcal I$,
and obtain an element that is generated by $\mathcal G$.
But then $f$ itself is generated by $\mathcal G$,
which is a contradiction.
\end{proof}


\begin{proposition}
A set $\mathcal G$ is a Gr\"obner basis if the cosets of monomials
reduced with respect to it form a basis of the quotient operad. 
In this case, the result of long division of a polynomial by
$\mathcal G$ is independent of the choices or the order in
 which we perform the reductions. 
\end{proposition}

\begin{proof}
To begin, observe that 
the cosets of monomials that are reduced with respect
to $\mathcal G$ form a basis of the quotient operad precisely
when every coset of $\mathcal I$ contains a unique element
that is reduced with respect to $\mathcal G$. 

By the long division algorithm, it follows that every coset
contains at least one element that is reduced with respect to $\mathcal G$,
so it suffices we prove that this element is unique if and only if
$\mathcal G$ is a Gr\"obner basis.

Thus, first suppose that $\mathcal G$ is a Gr\"obner basis, but that
there exist two $\mathcal G$-reduced monomials that have the same
coset modulo $\mathcal I$. This means there exists a $\mathcal G$-reduced 
polynomial in $\mathcal I$, which means that its leading term is
$\mathcal G$-reduced, which is impossible.

Conversely, Suppose that $\mathcal G$ is not a Gr√∂bner basis. It follows
that there is an element $f\in\mathcal I$ which is reduced with respect to 
$\mathcal G$. If we let $\overline{f}$ be the result of the long division of
$f$ by $\mathcal G$, we see we obtain a non-trivial linear combination of reduced 
monomials belonging to $\mathcal I$, so that there is not a unique
reduced representative for the zero coset.

Finally, suppose that for some $f$, two different choices of order of reductions yield two different outputs. Then, then there exist a coset $f + I$ which contains two different elements that are reduced with respect to $\GG$, hence reduced monomials are linearly dependent, a contradiction.
\end{proof}

\begin{theorem}
Every ideal admits a unique reduced Gr\"obner basis.
\end{theorem}

\begin{proof}
We begin by proving uniqueness, which will in fact tell us
how to prove these exist. Thus, suppose $\GG$ is a 
Gr\"obner basis of an idea $\II$, so that
$\leadm{\GG}$ generates $\leadm{\II}$. If $\GG$ is
also reduced, then $\leadm{\GG}$ coincides with the set
\[ 
 \mathcal M = \{ T\in \leadm{\II} : \text{$T$ is not divisible by any
 other element of  $\leadm{\II}$}.
 	\}
	\]
of all minimal elements of $\leadm{\II}$ partially ordered
with respect to divisibility. To see this, not that if
$T\in \mathcal M$ then this must be divisible by at least
one element $g$ of $\GG$, and this can only happen 
if $\leadm{g} = T$. Conversely, if $T$ is a leading monomial
in $\leadm{\GG}$ then it is certainly a leading monomial
of $\leadm{\II}$. If $T'$ is any other
leading monomial of $\leadm{\II}$ that divides $T$, then there is
$T''\in \leadm{\GG}$ that divides $T'$, and hence $T$. But
since $\GG$ is reduced, this happens only if $T''=T$, and
hence no other leading term divides $T$.

In addition, the fact that $\GG$ is reduced guarantees
that for each $T\in\leadm{\GG}$ there exists a unique element
$g\in\GG$ such that $g= T-h$ and $h$ is reduced with
respect to $\II$. It follows that $h$ must be equal to the
unique element in the coset $T+\II$ that is reduced
with respect to $\II$.

To prove existence, we consider the set $\mathcal{M}$ above,
and let $\GG$ consist of those elements of the form $T-h$
where $T\in \mathcal{M}$ and $h$ is the unique element in
the coset $T+\II$ that is reduced with respect to $\II$. 
By our definition of $\mathcal M$, the set $\GG$ is self-reduced, 
so it suffices we show that it is a Gr\"obner basis. 
To do this, notice that every element of $\leadm{\II}$
is divisible by an element of $\mathcal M$: if not,
the smallest element which is not divisible by some
element of $\mathcal M$ is either not divisible by
any other element of $\leadm{\II}$, which makes it an element
of $\mathcal M$, or otherwise is divisible by some
smaller element of $\leadm{\II}$, and hence actually
does have a divisor from $\mathcal M$. Thus,
$\leadm{\GG}$ generates $\leadm{\II}$, as we wanted.
\end{proof}

It is important to point out that our proof above is highly
non-constructive: we are considering the poset of
leading terms of $\II$ under divisibility, 
which we admits a (possibly infinite) set of 
minimal elements, and arguing these constitute the
reduced Gr\"obner basis of~$\II$. In the Lecture~\ref{lecture:GB2}, we will learn how to begin with any generating
set of $\II$, and complete it to a (possibly infinite)
reduced Gr\"obnber basis.
 
Let us conclude this lecture with a perhaps technical
lemma that describes how the insertion operation
works when it is iterated. It will be useful when we
give a proof of one of the handful of important results 
in these lectures.

\begin{lemma}\label{lemma:repl}
Let us consider the situation where $T,T_1,T_1'$ and $T_2$ 
are tree monomials, and that $T_1$ divides $T$ and
$T_2$ divides $T_1'$. Assume that $T_1'$ and $T_1$ have
the same arity, so that we may put $T_3 = \repl{T_1}{T}{T_1'}$.
Then $T_2$ divides $T_3$ and, as operations on tree monomials,
we have that
\[ 
\repl{T_1}{T}{\repl{T_2}{T_1'}{-}}= 
 	\repl{T_2}{T_3}{-}.
\]
In particular, if $T_1=T_1'$ so that $T_3 = T$, this
simplifies to 
\[ 
\repl{T_1}{T}{\repl{T_2}{T_1}{-}}= 
 	\repl{T_2}{T}{-}.
\]
\end{lemma}

We leave the proof as Exercise~\ref{ex:repl}, and
strongly suggest the reader to draw a picture, which
may well be enough to convince themselves of the
validity of the lemma. 

\subsection{Exercises}

\begin{question}
Prove the claim made in the last paragraph above:
the ideal of leading terms of $\II$, partially ordered by
divisibility, admits a possibly infinite set of
minimal elements. \emph{Hint:} divisibility
refines our choice of total order $\prec$: if 
$T$ divides $T'$, then $T\prec T'$. 
\end{question}

\begin{question}\label{ex:self-reduction}
Translate the self-reduction algorithm into prose
and prove Proposition~\ref{lemma:self-reduction}.
\end{question}

\begin{question}\label{ex:repl}
Give a proof of Lemma~\ref{lemma:repl}.
\end{question}

\begin{question}
Look up examples
of associative algebras
with a presentation and choice
of monomial order that leads to
an infinite reduced Gr\"obner
basis. Why does this never happen
for commutative algebras?
\end{question}
\vfill

 